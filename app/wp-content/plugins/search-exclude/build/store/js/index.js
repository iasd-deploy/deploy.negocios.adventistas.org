(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{FIRST_WP_VERSION_WITH_THUNK_SUPPORT:()=>v,INITIAL_STATE:()=>c,QLSE_REST_ROUTES:()=>h,QUADLAYERS_QLSE_STORE_NAME:()=>U,STORE_NAME:()=>d,WP_VERSION:()=>E,actions:()=>i,applyThunkMiddleware:()=>_,fetchRestApiSettings:()=>w,isVersionLessThan:()=>D,reducer:()=>a,resolvers:()=>n,selectors:()=>s,useDisplaySettings:()=>x,useExcludedSettings:()=>R});var s={};e.r(s),e.d(s,{getSettingsDisplay:()=>o,getSettingsExcluded:()=>l});var i={};e.r(i),e.d(i,{saveDisplaySettings:()=>m,saveExcludedSettings:()=>P,saveSettings:()=>b,setSettingsDisplay:()=>O,setSettingsExcluded:()=>T});var n={};e.r(n),e.d(n,{getSettingsDisplay:()=>A,getSettingsExcluded:()=>j});var a={};e.r(a),e.d(a,{default:()=>I,display:()=>N,excluded:()=>k});const r=window.wp.data,d="qlse/settings",c={display:{devices:"all",target:{include:1,ids:[]},entries:{post:{include:1,ids:[]},page:{include:1,ids:[]}},taxonomies:{category:{include:1,ids:[]},tags:{include:1,ids:[]},product_cat:{include:1,ids:[]}}},excluded:[]},o=e=>e.display,l=e=>e.excluded,u=window.wp.i18n,g=window.wp.notices,p=window.wp.apiFetch;var S=e.n(p);const y=window.wp.url,{QLSE_REST_ROUTES:h,WP_VERSION:E}=qlseStore,v="6.0",w=({method:e,data:t,route:s}={})=>async function(e){return await S()(e).then((e=>{if(e.code)throw e;return e})).catch((e=>e?.data?.params&&e?.data?.status?{code:e.data.status,message:Object.values(e.data.params)[0]}:{code:e?.code?e.code:"Unknown",message:e?.message?e.message:"Unknown"}))}({path:"GET"===e?(0,y.addQueryArgs)(h[s],t):h[s],method:e,data:t});function x(){const{setSettingsDisplay:e,saveDisplaySettings:t}=(0,r.useDispatch)(d),{settingsDisplay:s,isResolvingSettingsDisplay:i,hasResolvedSettingsDisplay:n}=(0,r.useSelect)((e=>{const{getSettingsDisplay:t,isResolving:s,hasFinishedResolution:i}=e(d);return{settingsDisplay:t(),isResolvingSettingsDisplay:s("getSettingsDisplay"),hasResolvedSettingsDisplay:i("getSettingsDisplay")}}),[]);return{settingsDisplay:s,isResolvingSettingsDisplay:i,hasResolvedSettingsDisplay:n,hasSettingsDisplay:!(!n||!Object.keys(s)?.length),saveDisplaySettings:t,setSettingsDisplay:e}}function R(){const{setSettingsExcluded:e,saveExcludedSettings:t}=(0,r.useDispatch)(d),{settingsExcluded:s,isResolvingSettingsExcluded:i,hasResolvedSettingsExcluded:n}=(0,r.useSelect)((e=>{const{getSettingsExcluded:t,isResolving:s,hasFinishedResolution:i}=e(d);return{settingsExcluded:t(),isResolvingSettingsExcluded:s("getSettingsExcluded"),hasResolvedSettingsExcluded:i("getSettingsExcluded")}}),[]);return{settingsExcluded:s,isResolvingSettingsExcluded:i,hasResolvedSettingsExcluded:n,hasSettingsExcluded:!(!n||!Object.keys(s)?.length),saveExcludedSettings:t,setSettingsExcluded:e}}const D=(e,t)=>{const s=e.split(".").map(Number),i=t.split(".").map(Number);for(let e=0;e<i.length;e++){if(s[e]<i[e])return!0;if(s[e]>i[e])return!1}return!1},_=e=>{const t=e.instantiate;return e.instantiate=e=>{const s=t(e);if(!s.store||!s.store.dispatch)throw new Error((0,u.__)("The created instance does not contain a valid store.","search-exclude"));const i=s.store.dispatch,n=((e,t)=>({registry:t,get dispatch(){return Object.assign((t=>e.store.dispatch(t)),e.getActions())},get select(){return Object.assign((t=>t(e.store.__unstableOriginalGetState())),e.getSelectors())},get resolveSelect(){return e.getResolveSelectors()}}))(s,e);return s.store.dispatch=((e,t)=>s=>"function"==typeof s?s(e):t(s))(n,i),s},e};function f(e,t){const s={};return new Set([...Object.keys(e),...Object.keys(t)]).forEach((i=>{e.hasOwnProperty(i)&&t.hasOwnProperty(i)?!function(e){const t=typeof e;return null!=e&&("object"==t||"function"==t)}(e[i])||Array.isArray(e[i])?s[i]=t[i]:s[i]=f(e[i],t[i]):e.hasOwnProperty(i)?s[i]=e[i]:t.hasOwnProperty(i)&&(s[i]=t[i])})),s}const O=e=>({type:"SET_DISPLAY",payload:t=>f(t,e)}),T=e=>({type:"SET_EXCLUDED",payload:()=>e}),b=(e,t)=>async({registry:s,dispatch:i,select:n})=>{let a;if(!t)throw new Error("Route is required.");switch(t){case"excluded":a={...n.getSettingsDisplay(),excluded:e};break;case"display":a={...n.getSettingsExcluded(),display:e}}const r=t.charAt(0).toUpperCase()+t.slice(1),d=await w({method:"POST",data:a,route:t});return d?.code?(s.dispatch(g.store).createSuccessNotice((0,u.sprintf)("%s: %s",d.code,d.message),{type:"snackbar"}),!1):(i[`setSettings${r}`](e),s.dispatch(g.store).createSuccessNotice((0,u.sprintf)((0,u.__)("%s settings saved.","search-exclude"),r),{type:"snackbar"}),!0)},m=e=>b(e,"display"),P=e=>b(e,"excluded"),A=async()=>{try{const e=await w({route:"display"});return O(e)}catch(e){console.error(e)}},j=async()=>{try{const e=await w({route:"excluded"});return T(e?.excluded)}catch(e){console.error(e)}};function N(e=c.display,t){return"SET_DISPLAY"===t.type?t.payload(e):e}function k(e=c.excluded,t){return"SET_EXCLUDED"===t.type?t.payload(e):e}const I=(0,r.combineReducers)({display:N,excluded:k}),L=(0,r.createReduxStore)(d,{reducer:I,actions:i,selectors:s,resolvers:n});(0,r.register)(D(E,v)?_(L):L);const U=d;(window.qlse=window.qlse||{}).store=t})();